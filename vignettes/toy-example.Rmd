---
title: "toy-example"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{toy-example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

#####################
#### TOY EXAMPLE ####
#####################

This script shows a toy example of usage of SparseFunClust (without alignment).

# Generate the data

```{r, eval = FALSE}
n <- 100
x <- seq(0,1,len=1000)
out <- SparseFunClust:::generate.data.FV17(n, x)
data <- out$data
trueClust <- out$true.partition
```
# Run Sparse Functional Clustering (no alignment)

```{r, eval = FALSE}
K <- 2           # run with 2 groups only
method <- 'kmea' # version with K-means clustering
m.tuned <- SparseFunClust:::FKMSparseClustering.permute(data, x, K, method=method)$m
result <- SparseFunClust:::FKMSparseClustering(data, x, K, m.tuned, method)
```

# Plot / explore results

```{r, eval = FALSE}
table(trueClust,result$CLUSTER)
SparseFunClust:::cer(trueClust,result$CLUSTER)
```

```{r, eval = FALSE}
par(mfrow=c(1,2))
matplot(x,t(data),type='l',lty=1,col=result$CLUSTER+1,ylab='',
        main='SparseFunClust - clustering results')
lines(x,colMeans(data[which(result$CLUSTER==1),]),lwd=2)
lines(x,colMeans(data[which(result$CLUSTER==2),]),lwd=2)
plot(x,result$W,type='l',lty=1,lwd=2,ylab='',main='SparseFunClust - Estimated Weighting function')
abline(v=0.5)
```
